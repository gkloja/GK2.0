<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configura√ß√µes</title>
<style>
   @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Roboto:wght@400;700&display=swap');

body {
    font-family: 'Roboto', sans-serif;
    background: linear-gradient(135deg, #1a1a1a, #333);
    color: #fff;
    margin: 0;
    padding: 0;
    text-align: center;
    overflow-x: hidden;
}

header {
    padding: 40px 20px;
    background: #000;
    box-shadow: 0 6px 20px rgba(255, 215, 0, 0.15);
    border-bottom: 2px solid #FFD700;
}

h1 {
    margin: 0;
    font-family: 'Orbitron', sans-serif;
    font-size: 3.2em;
    color: #FFD700;
    letter-spacing: 2px;
    text-shadow: 0 2px 8px rgba(255, 215, 0, 0.3);
    text-transform: uppercase;
}

p {
    font-size: 1.2em;
    color: #ddd;
    margin-top: 8px;
    opacity: 0.85;
}

.container {
    max-width: 1100px;
    margin: 50px auto;
    padding: 20px;
}

.card {
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 15px;
    padding: 30px;
    margin-bottom: 30px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.card:hover {
    transform: translateY(-6px);
    box-shadow: 0 16px 40px rgba(0, 0, 0, 0.5);
}

.info-label {
    display: block;
    font-weight: bold;
    font-size: 1.2em;
    margin-bottom: 6px;
    color: #FFD700;
}

.info-value {
    font-size: 1.6em;
    color: #FFA500;
}

input, select, button {
    display: block;
    margin: 14px auto;
    padding: 12px 18px;
    font-size: 1.1em;
    border: none;
    border-radius: 10px;
    transition: all 0.3s ease;
    width: 90%;
    max-width: 320px;
}

input, select {
    background: rgba(255, 255, 255, 0.08);
    color: #fff;
    text-align: center;
    outline: none;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

input:focus, select:focus {
    border-color: #FFD700;
    box-shadow: 0 0 8px #FFD70055;
}

button {
    background: #FFD700;
    color: #000;
    font-weight: bold;
    cursor: pointer;
    text-transform: uppercase;
    letter-spacing: 1px;
    box-shadow: 0 4px 14px rgba(255, 215, 0, 0.3);
}

button:hover {
    background: #FFA500;
    transform: scale(1.05);
    box-shadow: 0 6px 20px rgba(255, 140, 0, 0.4);
}

.music-button {
    position: fixed;
    bottom: 30px;
    right: 30px;
    background-color: #000;
    color: #FFD700;
    padding: 20px;
    border: none;
    border-radius: 50%;
    font-size: 2.2em;
    cursor: pointer;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.6);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.music-button:hover {
    transform: scale(1.1);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.8);
}

#result {
    margin-top: 20px;
    font-size: 1.4em;
    font-weight: bold;
    color: #FFD700;
    text-shadow: 0 2px 6px rgba(0, 0, 0, 0.5);
}

.highlight {
    color: #FFD700;
    font-weight: 700;
    letter-spacing: 0.5px;
    text-shadow: 0 1px 3px rgba(255, 215, 0, 0.3);
}
</style>
</head>
<body>

    <header>
        <h1>‚öôÔ∏è</h1>
    </header>
<!-- CONTAINER PRINCIPAL -->
<div id="group-stats" class="dashboard"></div>

<div class="charts-wrapper">
  <div class="chart-card">
    <h3>üìà Evolu√ß√£o di√°ria</h3>
    <canvas id="chartDaily"></canvas>
  </div>

  <div class="chart-card">
    <h3>üìä Vis√£o Semanal</h3>
    <canvas id="chartWeekly"></canvas>
  </div>
</div>

<style>
/* ===== Dashboard ===== */
.dashboard {
  display: flex;
  flex-direction: column;
  gap: 20px;
  padding: 10px;
}

.day-card {
  background: linear-gradient(135deg, #0a0f1c, #131c32);
  color: #e6eef8;
  border-radius: 14px;
  padding: 18px;
  border: 1px solid rgba(0,255,255,0.08);
  box-shadow: 0 8px 25px rgba(0,0,0,0.45);
  position: relative;
  cursor: pointer;
  transition: all 0.3s ease;
}

.day-card.today {
  border: 2px solid #4bc0c0;
  box-shadow: 0 10px 28px rgba(75,192,192,0.6);
}

.day-card.collapsed .user-list {
  display: none;
  opacity: 0;
  height: 0;
}

.day-card.collapsed .day-totals {
  opacity: 0.6;
}

.day-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 12px 28px rgba(75,192,192,0.35);
}

.day-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 14px;
}

.day-date {
  font-weight: 700;
  color: #6fbaff;
  font-size: 17px;
}

.day-totals {
  font-weight: 700;
  color: #ffd700;
  font-size: 16px;
  transition: opacity 0.3s;
}

.user-list {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  gap: 12px;
}

.user-item {
  display: flex;
  align-items: center;
  gap: 12px;
  background: rgba(255,255,255,0.03);
  padding: 10px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.05);
  text-decoration: none;
  color: #e6eef8;
  backdrop-filter: blur(4px);
  transition: transform 0.2s, border-color 0.2s;
}

.user-item:hover {
  transform: translateY(-3px);
  border-color: rgba(100,149,237,0.3);
}

.user-photo img {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  object-fit: cover;
  border: 2px solid rgba(255,255,255,0.2);
}

.user-info {
  flex: 1;
}

.user-name {
  font-size: 15px;
  font-weight: 600;
}

.user-stats {
  font-size: 13px;
  color: #9fb3d6;
}

.user-total {
  font-size: 17px;
  font-weight: 700;
  color: #ffcc80;
}

.charts-wrapper {
  margin-top: 30px;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(360px, 1fr));
  gap: 20px;
}

.chart-card {
  background: linear-gradient(135deg, #0d1325, #1b2843);
  padding: 20px;
  border-radius: 14px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.45);
  color: #cfdfff;
}

.chart-card h3 {
  margin-bottom: 12px;
  color: #c8e4ff;
}
</style>

<script>
let chartDaily = null;
let chartWeekly = null;

const GROUP_ID = "<%= grupo %>";
const countUrl = "/countmsg.json";
const registroUrl = "/registro.json";

// Carrega dados
async function carregarDados() {
  try {
    const [respCount, respReg] = await Promise.allSettled([
      fetch(countUrl),
      fetch(registroUrl).catch(()=>null)
    ]);

    if (respCount.status !== 'fulfilled') throw respCount.reason;

    const dadosCount = await respCount.value.json();
    const registro = (respReg.status === 'fulfilled') ? await respReg.value.json() : [];

    const infoGrupo = (Array.isArray(dadosCount) ? dadosCount : [dadosCount])
      .find(g => String(g.groupId || g.grupoID || "") === String(GROUP_ID));

    return { infoGrupo, registro };
  } catch(err) {
    console.error("Falha ao carregar dados:", err);
    return null;
  }
}

// Render cards com colapso criativo
function renderCards(infoGrupo, registro) {
  const container = document.getElementById("group-stats");
  const dias = Object.keys(infoGrupo.stats || {}).sort((a,b)=>
    new Date(b+"T03:00:00") - new Date(a+"T03:00:00")
  );

  const today = new Date();
  today.setHours(today.getHours() - 3);
  const todayStr = today.toISOString().split("T")[0];

  const htmlCards = dias.map(dia => {
    const totals = infoGrupo.stats[dia];

    const users = (infoGrupo.numbers || []).map(u => {
      const s = u.stats?.[dia] || { mensagens:0, figurinhas:0, comandos:0 };
      const numero = u.id.replace(/@.*/,"");
      const reg = registro.find(r => r.numero === u.id || r.numero === numero);

      return {
        id: numero,
        nome: reg?.nome || numero,
        foto: reg?.fotoPerfil ||
              `https://ui-avatars.com/api/?name=${encodeURIComponent(reg?.nome||numero)}&size=96&background=random`,
        mensagens: s.mensagens || 0,
        figurinhas: s.figurinhas || 0,
        comandos: s.comandos || 0,
        total: (s.mensagens||0)+(s.figurinhas||0)+(s.comandos||0)
      };
    })
    .filter(u => u.total > 0)
    .sort((a,b)=>b.total - a.total)
    .slice(0,5);

    const usersHTML = users.map((u,idx)=>`
      <a class="user-item" href="https://wa.me/${u.id}" target="_blank">
        <div class="user-photo"><img src="${u.foto}" alt="${u.nome}"></div>
        <div class="user-info">
          <div class="user-name">${idx+1}. ${u.nome}</div>
          <div class="user-stats">üí¨ ${u.mensagens} ‚Ä¢ üòÄ ${u.figurinhas} ‚Ä¢ ‚öôÔ∏è ${u.comandos}</div>
        </div>
        <div class="user-total" title="Total de atividades">${u.total}</div>
      </a>
    `).join("");

    // s√≥ expande hoje
    const collapsedClass = dia===todayStr ? '' : 'collapsed';

    return `
      <div class="day-card ${dia===todayStr?'today':''} ${collapsedClass}" onclick="this.classList.toggle('collapsed')">
        <div class="day-header">
          <div class="day-date">üìÖ ${dia}${dia===todayStr?' (Hoje)':''}</div>
          <div class="day-totals" title="üí¨ Mensagens: ${totals.mensagens} ‚Ä¢ üòÄ Figurinhas: ${totals.figurinhas} ‚Ä¢ ‚öôÔ∏è Comandos: ${totals.comandos}">
            üí¨ ${totals.mensagens} ‚Ä¢ üòÄ ${totals.figurinhas} ‚Ä¢ ‚öôÔ∏è ${totals.comandos}
          </div>
        </div>
        <div class="user-list">
          ${usersHTML || `<div class="user-stats">Nenhuma atividade neste dia.</div>`}
        </div>
      </div>
    `;
  }).join("");

  container.innerHTML = htmlCards;
}

// Mantemos seus gr√°ficos di√°rios e semanais iguais
function renderDailyChart(infoGrupo, registro) {
  const today = new Date();
  today.setHours(today.getHours() - 3);
  const todayStr = today.toISOString().split("T")[0];

  const todayUsers = (infoGrupo.numbers || []).map(u=>{
    const s = u.stats?.[todayStr] || { mensagens:0, figurinhas:0, comandos:0 };
    const numero = u.id.replace(/@.*/,"");
    const reg = registro.find(r => r.numero===u.id || r.numero===numero);

    return {
      nome: reg?.nome || numero,
      mensagens: s.mensagens||0,
      figurinhas: s.figurinhas||0,
      comandos: s.comandos||0
    };
  })
  .filter(u=>u.mensagens+u.figurinhas+u.comandos>0)
  .sort((a,b)=>(b.mensagens+b.figurinhas+b.comandos)-(a.mensagens+a.figurinhas+a.comandos))
  .slice(0,5);

  const ctx = document.getElementById("chartDaily").getContext("2d");

  const labels = todayUsers.map(u=>u.nome);

  const data = {
    labels,
    datasets: [
      { label:"Mensagens", data:todayUsers.map(u=>u.mensagens), backgroundColor:"#4bc0c0" },
      { label:"Figurinhas", data:todayUsers.map(u=>u.figurinhas), backgroundColor:"#ffcc80" },
      { label:"Comandos", data:todayUsers.map(u=>u.comandos), backgroundColor:"#ff6f61" }
    ]
  };


  if (!chartDaily) {
    chartDaily = new Chart(ctx, {
      type: 'bar',
      data,
      options:{
        responsive:true,
        animation:{ duration:1200 },
        indexAxis:'y',
        plugins:{
          legend:{ position:'top' },
          title:{
            display:true,
            text:"üìä An√°lise di√°ria ‚Äî Veja o gr√°fico dos Top 5 mais ativos hoje"
          },
          tooltip:{ mode:'index', intersect:false }
        },
        scales:{ x:{ beginAtZero:true } }
      }
    });
  } else {
    chartDaily.data = data;
    chartDaily.update();
  }
}

function renderWeeklyChart(infoGrupo) {
  const diasSemana = ["Dom","Seg","Ter","Qua","Qui","Sex","S√°b"];
  const semanal = { mensagens:[], figurinhas:[], comandos:[] };
  const dias = Object.keys(infoGrupo.stats);

  diasSemana.forEach((_,i)=>{
    let msg=0, fig=0, cmd=0;
    dias.forEach(d=>{
      const date = new Date(d+"T03:00:00");
      if(date.getDay()===i){
        const s = infoGrupo.stats[d];
        msg+=s.mensagens||0;
        fig+=s.figurinhas||0;
        cmd+=s.comandos||0;
      }
    });
    semanal.mensagens.push(msg);
    semanal.figurinhas.push(fig);
    semanal.comandos.push(cmd);
  });

  const ctx = document.getElementById("chartWeekly").getContext("2d");
  const data = {
    labels: diasSemana,
    datasets:[
      { label:"Mensagens", data:semanal.mensagens, backgroundColor:"#4bc0c0" },
      { label:"Figurinhas", data:semanal.figurinhas, backgroundColor:"#ffcc80" },
      { label:"Comandos", data:semanal.comandos, backgroundColor:"#ff6f61" }
    ]
  };

  if (!chartWeekly) {
    chartWeekly = new Chart(ctx, {
      type:'bar',
      data,
      options:{
        responsive:true,
        animation:{ duration:1200 },
        plugins:{
          legend:{ position:'top' },
          title:{
            display:true,
            text:"üìä An√°lise semanal ‚Äî compara√ß√£o entre tipos de atividade"
          }
        },
        scales:{
          x:{ stacked:true },
          y:{ stacked:true, beginAtZero:true }
        }
      }
    });
  } else {
    chartWeekly.data = data;
    chartWeekly.update();
  }
}

// Atualiza√ß√£o autom√°tica
async function atualizarDashboard() {
  const dados = await carregarDados();
  if (!dados || !dados.infoGrupo) return;
  renderCards(dados.infoGrupo, dados.registro);
  renderDailyChart(dados.infoGrupo, dados.registro);
  renderWeeklyChart(dados.infoGrupo);
}

atualizarDashboard();
//setInterval(atualizarDashboard, 5000);
</script>
<div id="group-stats2" class="dashboard2"></div>

<div class="charts-wrapper2">
  <div class="chart-card2">
    <h3>üëë Top 3 Admins que mais baniram</h3>
    <div id="admin-rank2" class="admin-rank"></div>
  </div>
</div>

<style>
/* ===== DASHBOARD BANIDOS 2 ===== */
.dashboard2 {
  display: flex;
  flex-direction: column;
  gap: 20px;
  padding: 10px;
}

.day-card2 {
  background: linear-gradient(135deg, #1c1c2a, #2c3a50);
  color: #f0f0f0;
  border-radius: 14px;
  padding: 18px;
  border: 1px solid rgba(255,255,255,0.08);
  box-shadow: 0 8px 20px rgba(0,0,0,0.45);
  cursor: pointer;
  transition: all 0.3s ease;
}

.day-card2.today {
  border: 2px solid #ff6f61;
  box-shadow: 0 10px 28px rgba(255,111,111,0.6);
}

.day-card2.collapsed .user-list2 {
  display: none;
  opacity: 0;
  height: 0;
}

.day-card2.collapsed .day-totals2 {
  opacity: 0.6;
}

.day-card2:hover {
  transform: translateY(-2px);
  box-shadow: 0 12px 28px rgba(255,111,111,0.35);
}

.day-header2 {
  display: flex;
  justify-content: space-between;
  margin-bottom: 14px;
}

.day-date2 {
  font-weight: 700;
  color: #6fbaff;
  font-size: 17px;
}

.day-totals2 {
  font-weight: 700;
  color: #ffd700;
  font-size: 16px;
  transition: opacity 0.3s;
}

.user-list2 {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(260px,1fr));
  gap: 12px;
}

.user-item2 {
  display:flex; align-items:center; gap:12px;
  background: rgba(255,255,255,0.03); padding:10px;
  border-radius:12px; border:1px solid rgba(255,255,255,0.05);
  text-decoration:none; color:#f0f0f0; backdrop-filter: blur(4px);
  transition: transform 0.2s, border-color 0.2s;
}

.user-item2:hover { transform:translateY(-3px); border-color: rgba(255,111,111,0.3); }

.user-photo2 img { width:48px; height:48px; border-radius:50%; object-fit:cover; border:2px solid rgba(255,255,255,0.2); }
.user-info2 { flex:1; }
.user-name2 { font-size:15px; font-weight:600; }
.user-stats2 { font-size:13px; color:#9fb3d6; }
.user-total2 { font-size:17px; font-weight:700; color:#ff6f61; }

.charts-wrapper2 { margin-top:30px; display:grid; grid-template-columns:repeat(auto-fit,minmax(360px,1fr)); gap:20px; }

.chart-card2 {
  background: linear-gradient(135deg,#0d1325,#1b2843);
  padding:20px; border-radius:14px; box-shadow:0 8px 20px rgba(0,0,0,0.45); color:#cfdfff;
}

.chart-card2 h3 { margin-bottom:12px; color:#c8e4ff; }

/* ===== RANK DE ADMINS ===== */
.admin-rank {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px,1fr));
  gap: 15px;
}

.admin-card {
  background: linear-gradient(135deg,#2a2a3a,#3b4a60);
  border-radius: 12px;
  padding: 12px;
  display: flex;
  align-items: center;
  gap: 10px;
  box-shadow: 0 6px 20px rgba(0,0,0,0.35);
  transition: transform 0.2s, box-shadow 0.2s;
}

.admin-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 10px 25px rgba(0,0,0,0.5);
}

.admin-photo {
  width:50px; height:50px; border-radius:50%; border:2px solid rgba(255,255,255,0.2); overflow:hidden;
}

.admin-photo img { width:100%; height:100%; object-fit:cover; }

.admin-info {
  flex:1;
}

.admin-name {
  font-size:15px; font-weight:700; color:#6fbaff;
}

.admin-bans {
  font-size:14px; font-weight:600; color:#ff6f61;
}
</style>

<script>
const GROUP_ID2 = "<%= grupo %>";
const banidosUrl2 = "/banidos.json";
const registroUrl2 = "/registro.json";

// Carrega banidos
async function carregarBanidos2() {
  const [resBanidos, resRegistro] = await Promise.allSettled([
    fetch(banidosUrl2),
    fetch(registroUrl2)
  ]);

  const banidosRaw = resBanidos.status === 'fulfilled' ? await resBanidos.value.json() : {};
  const registro = resRegistro.status === 'fulfilled' ? await resRegistro.value.json() : [];
  const infoGrupo = banidosRaw[GROUP_ID2] || [];
  return { infoGrupo, registro };
}

// Render cards colaps√°veis por dia
function renderCards2(infoGrupo, registro) {
  const container = document.getElementById("group-stats2");
  const diasMap = {};
  infoGrupo.forEach(u => { if (!diasMap[u.data]) diasMap[u.data] = []; diasMap[u.data].push(u); });

  const dias = Object.keys(diasMap).sort((a,b)=> new Date(b) - new Date(a));
  const todayStr = new Date().toISOString().split("T")[0];

  const htmlCards = dias.map(dia => {
    const usersHTML = diasMap[dia].map((u, idx)=>{
      const reg = registro.find(r=>r.numero===u.numero) || {};
      const nome = u.nome || reg.nome || u.numero.replace(/@.*/,'');
      const foto = reg.fotoPerfil || `https://ui-avatars.com/api/?name=${encodeURIComponent(nome)}&size=96&background=random`;
      return `
      <a class="user-item2" href="https://wa.me/${u.numero.replace(/@.*/,'')}" target="_blank">
        <div class="user-photo2"><img src="${foto}" alt="${nome}"></div>
        <div class="user-info2">
          <div class="user-name2">${idx+1}. ${nome}</div>
          <div class="user-stats2">Admin: ${u.admin.replace(/@.*/,'')} | Motivo: ${u.motivo || 'N√£o informado'} | Hora: ${u.hora}</div>
        </div>
      </a>`;
    }).join("");

    const collapsedClass = dia===todayStr ? '' : 'collapsed';

    return `
    <div class="day-card2 ${dia===todayStr?'today':''} ${collapsedClass}" onclick="this.classList.toggle('collapsed')">
      <div class="day-header2">
        <div class="day-date2">üìÖ ${dia}${dia===todayStr?' (Hoje)':''}</div>
        <div class="day-totals2" title="Total de banimentos: ${diasMap[dia].length}">
          üõë Total: ${diasMap[dia].length}
        </div>
      </div>
      <div class="user-list2">${usersHTML}</div>
    </div>`;
  }).join("");

  container.innerHTML = htmlCards;
}

// Render rank top 3 admins
function renderAdminRank2(infoGrupo, registro) {
  const adminCounts = {};
  infoGrupo.forEach(u => {
    const adminId = u.admin;
    adminCounts[adminId] = (adminCounts[adminId] || 0) + 1;
  });

  const sortedAdmins = Object.entries(adminCounts)
    .sort((a,b)=>b[1]-a[1])
    .slice(0,3); // top 3 admins

  const container = document.getElementById("admin-rank2");
  container.innerHTML = sortedAdmins.map(([adminId,count],idx)=>{
    const reg = registro.find(r=>r.numero===adminId) || {};
    const nome = reg.nome || adminId.replace(/@.*/,'');
    const foto = reg.fotoPerfil || `https://ui-avatars.com/api/?name=${encodeURIComponent(nome)}&size=96&background=random`;
    const medal = idx===0?'ü•á':idx===1?'ü•à':'ü•â';
    return `
    <div class="admin-card">
      <div class="admin-photo"><img src="${foto}" alt="${nome}"></div>
      <div class="admin-info">
        <div class="admin-name">${medal} ${nome}</div>
        <div class="admin-bans">üõë Banimentos: ${count}</div>
      </div>
    </div>
    `;
  }).join("");
}

// Atualiza√ß√£o autom√°tica
async function atualizarDashboard2() {
  const { infoGrupo, registro } = await carregarBanidos2();
  renderCards2(infoGrupo, registro);
  renderAdminRank2(infoGrupo, registro);
}

atualizarDashboard2();
setInterval(atualizarDashboard2, 5000);
</script>
 <!-- Informa√ß√µes do Usu√°rio -->
<div id="user-info" style="background-color: #f1f3f6; padding: 30px; border-radius: 15px; box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1); max-width: 450px; margin: 20px auto; font-family: 'Arial', sans-serif;">
    <h2 style="text-align: center; color: #2b3d51; font-size: 1.5em; margin-bottom: 20px; text-transform: uppercase; font-weight: 700;">üë§ Informa√ß√µes do Usu√°rio</h2>
    
  <div class="info-row">
    <span class="info-label">Usu√°rio:</span>
    <span class="info-value"> <%= username %> </span>
</div>
<div class="info-row">
    <span class="info-label">N√∫mero:</span>
    <span class="info-value"> <%= numero %> </span>
</div>
<div class="info-row">
    <span class="info-label">Grupo:</span>
    <span class="info-value"> <%= grupo %> </span>
</div>
<div class="info-row">
    <span class="info-label">Golds:</span>
    <span class="info-value">üí∞ <%= golds %> </span>
</div>
<div class="info-row">
    <span class="info-label">Ranking Global:</span>
    <span class="info-value">üèÜ <%= globalRank %> </span>
</div>
<div class="info-row">
    <span class="info-label">Status:</span>
    <span class="info-value"> <%= isAdmin ? '‚öñÔ∏èAdministrador' : 'Membro Comum' %> </span>
</div>
<style>@import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');

body {
    font-family: 'Roboto', sans-serif;
    background-color: #eef3fb;
    color: #222;
    margin: 0;
    padding: 0;
}

#toggleConfig {
    background: linear-gradient(135deg, #0066ff, #0044aa);
    color: white;
    border: none;
    padding: 16px 32px;
    font-size: 1.1em;
    font-weight: bold;
    cursor: pointer;
    border-radius: 50px;
    margin: 40px auto;
    display: block;
    max-width: 820px;
    width: 90%;
    transition: all 0.3s ease;
    text-transform: uppercase;
    letter-spacing: 1.2px;
    box-shadow: 0 8px 24px rgba(0, 102, 255, 0.35);
}

#toggleConfig:hover {
    background: linear-gradient(135deg, #004bb7, #003b92);
    transform: translateY(-3px);
    box-shadow: 0 12px 30px rgba(0, 102, 255, 0.5);
}

#configContainer {
    background-color: #fff;
    padding: 40px;
    border-radius: 20px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.08);
    width: 90%;
    max-width: 880px;
    margin: 0 auto 60px;
    transition: all 0.4s ease;
}

h3 {
    font-size: 28px;
    font-weight: 700;
    text-align: center;
    color: #003b92;
    border-bottom: 3px solid #0066ff;
    padding-bottom: 12px;
    margin-bottom: 32px;
    letter-spacing: 1px;
}

.checkbox-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 24px;
}

.form-group {
    display: flex;
    flex-direction: column;
    background: #f9fbff;
    padding: 18px;
    border-radius: 12px;
    border: 1px solid #dce6f2;
    box-shadow: 0 6px 18px rgba(0, 0, 0, 0.03);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.form-group:hover {
    transform: translateY(-4px);
    box-shadow: 0 10px 28px rgba(0, 0, 0, 0.05);
}

.form-group label {
    font-size: 16px;
    color: #333;
    margin-bottom: 10px;
    font-weight: 600;
}

.form-group input[type="checkbox"] {
    transform: scale(1.3);
    cursor: pointer;
    accent-color: #0066ff;
}

.status {
    font-weight: bold;
    padding: 6px 14px;
    border-radius: 50px;
    margin-top: 12px;
    font-size: 14px;
    text-align: center;
}

.active {
    background-color: #28a745;
    color: #fff;
}

.inactive {
    background-color: #dc3545;
    color: #fff;
}

.text-options {
    display: block;
    width: 100%;
    margin-top: 30px;
}

.text-options .form-group {
    margin-bottom: 24px;
}

.text-options input[type="text"] {
    padding: 16px;
    border: 1px solid #ccd6e6;
    border-radius: 10px;
    font-size: 16px;
    width: 100%;
    background: #f0f4fb;
    color: #333;
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
}

.text-options input[type="text"]:focus {
    border-color: #0066ff;
    box-shadow: 0 0 10px rgba(0, 102, 255, 0.3);
    outline: none;
    background: #ffffff;
}

button[type="submit"] {
    background: linear-gradient(135deg, #0066ff, #0044aa);
    color: white;
    padding: 18px 32px;
    border: none;
    font-size: 1.1em;
    font-weight: bold;
    cursor: pointer;
    border-radius: 50px;
    width: 100%;
    max-width: 880px;
    display: block;
    margin: 40px auto 0;
    box-shadow: 0 10px 28px rgba(0, 102, 255, 0.4);
    text-transform: uppercase;
    letter-spacing: 1.3px;
    transition: all 0.3s ease;
}

button[type="submit"]:hover {
    background: linear-gradient(135deg, #004bb7, #003b92);
    transform: translateY(-3px);
    box-shadow: 0 14px 34px rgba(0, 102, 255, 0.5);
}

button[type="submit"]:active {
    background: linear-gradient(135deg, #002c6c, #001a44);
    transform: translateY(1px);
    box-shadow: 0 6px 16px rgba(0, 102, 255, 0.3);
}

@media (max-width: 768px) {
    #toggleConfig {
        max-width: 100%;
    }

    #configContainer {
        padding: 24px;
    }

    .checkbox-grid {
        grid-template-columns: 1fr;
    }
}
</style>

<% if (isAdmin) { %>  <!-- Verifica se o usu√°rio √© admin -->


    <div id="configContainer">
        <h3>Configura√ß√µes Gerais</h3>
        <form method="POST" action="/alterarConfig">

            <h4 style="text-align:center; margin-bottom: 15px;"></h4>
            <% 
            const nomesAmigaveis = {
    "visuUnica": "üëÅÔ∏è Revelar Visualiza√ß√µes √önicas (Revele as m√≠dias!)",
    "x9": "üéØ Somente o Dono Promove (Somente o dono pode dar o poder!)",
    "soadm": "üëë Somente Administrador pode utilizar a Rob√¥ (Apenas o admin tem o controle total!)",
    "antiimg": "üñºÔ∏è Bloquear Imagens (A Pessoa s√≥ pode mandar em visualiza√ß√£o √∫nica, se n√£o a mensagem √© apagada!)",
    "antivideo": "üé• Bloquear V√≠deos (A Pessoa s√≥ pode mandar em visualiza√ß√£o √∫nica, se n√£o a mensagem √© apagada!)",
    "antiaudio": "üîä Bloquear √Åudios (Banimento em quem mandar √°udios no grupo!)",
    "antisticker": "üí¨ Bloquear Figurinhas (Banimento em quem mandar figurinhas no grupo!)",
    "antidoc": "üìÑ Bloquear Documentos (Evite travas de documentos indesejados!)",
    "antictt": "üìû Bloquear Contatos (Evita trava de contatos no grupo!)",
    "antiloc": "üìç Bloquear Localiza√ß√µes (Proteja contra travas de Loc!)",
    "antilinkgp": "üîó Remover Links de Grupo (Nada de links n√£o autorizados!)",
    "level": "üîù Remover Links de Canal (Evita spam de canais!)",
    "antilinkhard": "üõë Remover Todos os Links (Controle total sobre links!)",
    "antifake": "üïµÔ∏è‚Äç‚ôÇÔ∏è Bloquear N√∫meros Fakes (Proteja o grupo contra fakes!)",
    "antispam": "üö´ Prevenir Spam (Quem mandar mais de 5Fig sem parar, √© advertido!)",
    "antinotas": "üí∏ Prevenir An√∫ncios (Sem mensagens de vendas indesejadas!) + üîû Anti-Porno",
    "simi1": "ü§ñ Chatbot Para Grupo de Not√≠cias (IA  para deixar o grupo informado!)",
    "gospel": "ü§ù Chatbot Para Grupo de Amizades (IA para os membros se conectarem!)",
    "autosticker": "üéâ Criar Figurinhas Automaticamente (Sem precisar de comando)",
    "jogos": "üéÆ Ativar Jogos (Divirta-se com os jogos no grupo! Use &menubrincadeira)",
    "sistemGold": "ü™ô Modo RPG (Entre nesse modo para competir golds no grupo e entre grupos!)",
    "nsfw": "‚ö†Ô∏è Verica todos os links que mandarem (Caso seja v√≠rus, ela apaga e bani)",
    "registrarFIGUS": "üéÅ Sistema de Bem-Vindo por Figurinhas (Receba figurinhas de boas-vindas!)",
        "autodl": "üì• Sistema de Baixar as m√≠dias automaticamente (Ap√≥s mandarem o link)",
                "Odelete": "üì• Baixar as m√≠dias em formato de V√≠deo (Se desativar vai ser em A√∫dio)"
};
            %>

            <div class="checkbox-grid">
                <% ["sistemGold", "visuUnica", "x9", "soadm", "antiimg", "antivideo", "antiaudio", 
                    "antisticker", "antidoc", "antictt", "antiloc", "antilinkgp", "level", "antilinkhard", "antifake", 
                    "antispam", "antinotas", "simi1", "gospel",  "autosticker","autodl","Odelete","jogos", "registrarFIGUS"].forEach(config => { %>
                    <div class="form-group">
                        <label><%= nomesAmigaveis[config] || config.replace(/([A-Z])/g, ' $1').toUpperCase() %>:</label>
                        <input type="checkbox" name="<%= config %>" <%= grupoConfig[0][config] ? "checked" : "" %> />
                        <span class="status <%= grupoConfig[0][config] ? 'active' : 'inactive' %>">
                            <%= grupoConfig[0][config] ? 'Ativo' : 'Inativo' %>
                        </span>
                    </div>
                <% }) %>

<!-- Ativar/Desativar Bem-Vindo -->
<div class="form-group">
    <label>üé∂ Ativar Boas-Vindas com √Åudio:</label>
    <input type="checkbox" name="bemvindo1" <%= grupoConfig[0].wellcome && grupoConfig[0].wellcome[0].bemvindo1 ? "checked" : "" %> />
    <span class="status <%= grupoConfig[0].wellcome && grupoConfig[0].wellcome[0].bemvindo1 ? 'active' : 'inactive' %>">
        <%= grupoConfig[0].wellcome && grupoConfig[0].wellcome[0].bemvindo1 ? 'üéâ Ativo' : '‚ùå Inativo' %>
    </span>
</div>

<!-- Legenda Bem-Vindo com √Åudio -->
<div class="form-group">
    <label>üé§ Legenda para Boas-Vindas (√Åudio):</label>
    <input type="text" name="legendabv" value="<%= grupoConfig[0].wellcome && grupoConfig[0].wellcome[0] ? grupoConfig[0].wellcome[0].legendabv : '' %>" />
    <small class="exemplo-texto">Exemplo: "Bem-vindo(a) ao grupo! üéâ"</small>
</div>

<!-- Ativar/Desativar Bem-Vindo com Texto + Imagem -->
<div class="form-group">
    <label>üìù Ativar Boas-Vindas com Texto e Imagem:</label>
    <input type="checkbox" name="bemvindo2" <%= grupoConfig[0].wellcome && grupoConfig[0].wellcome[1].bemvindo2 ? "checked" : "" %> />
    <span class="status <%= grupoConfig[0].wellcome && grupoConfig[0].wellcome[1].bemvindo2 ? 'active' : 'inactive' %>">
        <%= grupoConfig[0].wellcome && grupoConfig[0].wellcome[1].bemvindo2 ? 'üéâ Ativo' : '‚ùå Inativo' %>
    </span>
</div>

<!-- Legenda Bem-Vindo com Texto e Imagem -->
<div class="form-group">
    <label>üñºÔ∏è Legenda para Boas-Vindas (Texto + Imagem):</label>
    <input type="text" name="legendabv2" value="<%= grupoConfig[0].wellcome && grupoConfig[0].wellcome[1] ? grupoConfig[0].wellcome[1].legendabv : '' %>" />
    <small class="exemplo-texto">Exemplo: "Ol√° @#numerodele# Seja bem-vindo(a)! üòÉ Veja a descri√ß√£o: #descri√ß√£o#"</small>
</div>

<!-- Legenda de Sa√≠da com Texto e Imagem -->
<div class="form-group">
    <label>üö™ Legenda para Sa√≠da (Texto + Imagem):</label>
    <input type="text" name="legendasaiu2" value="<%= grupoConfig[0].wellcome && grupoConfig[0].wellcome[1] ? grupoConfig[0].wellcome[1].legendasaiu : '' %>" />
    <small class="exemplo-texto">Exemplo: "At√© logo! üëã @#numerodele#"</small>
</div>

<style>
    /* Estilo criativo para as legendas de exemplo */
    .exemplo-texto {
        display: block;
        margin-top: 5px;
        font-size: 14px;
        color: #2d2d2d;
        font-style: italic;
        background-color: #f0f8ff;
        padding: 8px;
        border-radius: 5px;
        border: 1px solid #aaa;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
    }
    
    .exemplo-texto:hover {
        background-color: #d1ecf1;
        border-color: #5bc0de;
        transform: scale(1.05);
    }
</style>
                <button type="submit">Salvar Altera√ß√µes</button>
            </div>
        </form>
    </div>
<% } else { %>  <!-- Se o usu√°rio n√£o for admin -->
    <p>Voc√™ n√£o tem permiss√£o para acessar as configura√ß√µes do Grupo.</p>
<% } %>
<script>
    document.querySelectorAll("input[type='checkbox']").forEach(checkbox => {
    checkbox.addEventListener("change", function() {
        let nomeConfig = this.name;
        let status = this.checked ? "on" : "off";

        fetch('/alterarConfig', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ [nomeConfig]: status })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                let statusSpan = this.parentElement.querySelector(".status");
                if (statusSpan) {
                    statusSpan.textContent = this.checked ? "Ativo" : "Inativo";
                    statusSpan.className = this.checked ? "status active" : "status inactive";
                }
                alert(`Configura√ß√£o ${nomeConfig} ${this.checked ? "ativada" : "desativada"} com sucesso!`);
            } else {
                alert('Erro ao salvar configura√ß√£o.');
            }
        })
        .catch(error => console.error('Erro na requisi√ß√£o:', error));
    });
});
</script>

 



    <!-- Efeito de anima√ß√£o ao passar o mouse -->
<style>
    #user-info .info-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
        padding: 12px;
        border-radius: 8px;
        background-color: #ffffff;
        box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
    }
    #user-info .info-label {
        color: #4A90E2;
        font-weight: bold;
    }
    #user-info .info-value {
        color: #2d3748;
        font-size: 1.2em;
        font-weight: bold;
    }
    #user-info .info-row:hover {
        background-color: #f0f7ff;
        transform: translateY(-5px);
        transition: 0.3s ease;
    }

    /* Estilos do Menu Dropdown */
    .dropdown {
        position: relative;
        display: inline-block;
    }

    .dropdown-button {
        background-color: #4A90E2;
        color: white;
        padding: 12px 16px;
        font-size: 18px;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

    .dropdown-button:hover {
        background-color: #357ABD;
    }


.dropdown-btn {
    background: linear-gradient(135deg, #007bff, #0056b3);
    color: white;
    padding: 10px 14px;
    font-size: 18px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.3s ease;
}

.dropdown-btn:hover {
    background: linear-gradient(135deg, #0056b3, #003f7f);
}

/* Dropdown content */
.dropdown-content {
    display: none;
    position: absolute;
    top: 110%;
    right: 0;
    background-color: white;
    border-radius: 10px;
    box-shadow: 0 8px 16px rgba(0,0,0,0.2);
    min-width: 200px;
    z-index: 1000;
    overflow: hidden;
}

.dropdown:hover .dropdown-content {
    display: block;
}


</style>



<!-- Font Awesome (adicione isso no <head> se ainda n√£o tiver) -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

<div class="dropdown">
    <button class="dropdown-btn"><i class="fas fa-bars"></i></button>
    <div class="dropdown-content">
        <a href="/" class="dropdown-item"><i class="fas fa-trophy"></i> Ver Rank</a>
        <a href="/" class="dropdown-item"><i class="fas fa-gamepad"></i> Apostar </a>
        <a href="/change-password" class="dropdown-item"><i class="fas fa-key"></i> Alterar Senha</a>
        <a href="#" id="logout-button" class="dropdown-item"><i class="fas fa-sign-out-alt"></i> Sair</a>
        <a href="https://wa.me/5521989047220" target="_blank" class="dropdown-item"><i class="fas fa-headset"></i> Suporte</a>
    </div>
</div>
<style> /* Dropdown base */
.dropdown {
    position: relative;
    display: inline-block;
}

.dropdown-btn {
    background: linear-gradient(135deg, #007bff, #0056b3);
    color: white;
    padding: 10px 14px;
    font-size: 18px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.3s ease;
}

.dropdown-btn:hover {
    background: linear-gradient(135deg, #0056b3, #003f7f);
}

/* Dropdown content */
.dropdown-content {
    display: none;
    position: absolute;
    top: 110%;
    right: 0;
    background-color: white;
    border-radius: 10px;
    box-shadow: 0 8px 16px rgba(0,0,0,0.2);
    min-width: 200px;
    z-index: 1000;
    overflow: hidden;
}

.dropdown:hover .dropdown-content {
    display: block;
}

/* Dropdown items */
.dropdown-item {
    display: flex;
    align-items: center;
    padding: 12px 16px;
    color: #333;
    text-decoration: none;
    transition: background 0.3s ease;
    font-weight: 500;
}

.dropdown-item i {
    margin-right: 10px;
    color: #007bff;
    width: 20px;
    text-align: center;
}

.dropdown-item:hover {
    background-color: #f0f4ff;
    color: #007bff;
} </style>

<style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');

    body {
        font-family: 'Roboto', sans-serif;
        margin: 0;
        padding: 0;
        background-color: #1e2a47;
        color: #f0f0f0;
    }

    /* Bot√£o do chat */
    #chat-button {
        position: fixed;
        bottom: 20px;
        left: 20px;
        background: linear-gradient(135deg, #ffcc00, #ff9933);
        border: none;
        border-radius: 50%;
        padding: 22px;
        cursor: pointer;
        font-size: 26px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
        z-index: 1000;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    #chat-button:hover {
        transform: scale(1.15);
        box-shadow: 0 12px 35px rgba(0, 0, 0, 0.7);
    }

    /* Chat container */
    .chat-container {
        position: fixed;
        bottom: 80px;
        left: 20px;
        width: 340px;
        background: rgba(30, 42, 71, 0.98);
        padding: 25px;
        border-radius: 18px;
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.7);
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        height: 500px;
        transition: bottom 0.4s ease, transform 0.4s ease, opacity 0.4s ease;
        z-index: 999;
        opacity: 1;
    }

    .chat-container.hidden {
        opacity: 0;
        pointer-events: none;
        transform: translateY(100px);
    }

    h2 {
        font-size: 22px;
        color: #ffcc00;
        margin-bottom: 15px;
        text-align: center;
        text-transform: uppercase;
        letter-spacing: 1.5px;
        font-weight: 700;
    }

    #messages {
        list-style: none;
        padding: 0;
        flex-grow: 1;
        overflow-y: auto;
        margin-bottom: 20px;
        font-size: 15px;
        color: white;
    }

    #messages li {
        background: rgba(255, 255, 255, 0.05);
        margin: 10px 0;
        padding: 12px;
        border-radius: 12px;
        font-size: 16px;
        transition: background 0.3s ease, transform 0.3s ease;
    }

    #messages li:hover {
        background: rgba(255, 255, 255, 0.15);
        transform: translateX(6px);
    }

    .message-header {
        font-weight: bold;
        color: #ffcc00;
        margin-bottom: 4px;
        display: flex;
        align-items: center;
        font-size: 15px;
    }

    .message-time {
        font-size: 12px;
        color: #bbb;
        margin-left: 6px;
    }

    .message-body {
        color: #eee;
        font-size: 15px;
        line-height: 1.4;
    }

    .rank {
        display: inline-block;
        margin-left: 6px;
        background: linear-gradient(135deg, #ff5e62, #ff9966);
        color: white;
        padding: 3px 10px;
        border-radius: 20px;
        font-weight: bold;
        font-size: 12px;
    }

    form {
        display: flex;
        align-items: center;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        padding-top: 10px;
        margin-top: 10px;
    }

    input {
        flex-grow: 1;
        padding: 14px;
        border-radius: 10px;
        border: none;
        font-size: 15px;
        margin-right: 10px;
        background-color: rgba(46, 59, 81, 0.9);
        color: white;
        transition: background 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
    }

    input:focus {
        background-color: rgba(59, 74, 101, 1);
        outline: none;
        transform: scale(1.02);
        box-shadow: 0 0 8px rgba(255, 204, 0, 0.5);
    }

    button {
        padding: 14px;
        background: linear-gradient(135deg, #ffcc00, #ff9933);
        border: none;
        border-radius: 10px;
        cursor: pointer;
        font-size: 15px;
        transition: background 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
    }

    button:hover {
        background: linear-gradient(135deg, #ff9933, #ff5e00);
        transform: scale(1.05);
        box-shadow: 0 6px 18px rgba(255, 153, 51, 0.5);
    }

    button:active {
        transform: scale(0.97);
    }

    @keyframes slideIn {
        0% {
            opacity: 0;
            transform: translateY(100px);
        }
        100% {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .open-chat {
        animation: slideIn 0.5s ease-out forwards;
    }

    /* Barra de rolagem customizada para mensagens */
    #messages::-webkit-scrollbar {
        width: 8px;
    }

    #messages::-webkit-scrollbar-thumb {
        background: rgba(255, 204, 0, 0.5);
        border-radius: 4px;
    }

    #messages::-webkit-scrollbar-track {
        background: transparent;
    }
</style>
<script>
  const chatButton = document.getElementById("chat-button");
const chatContainer = document.getElementById("chat-container");
const form = document.getElementById("form");
const messages = document.getElementById("messages");

// Alterna a visibilidade do chat ao clicar no bot√£o
chatButton.addEventListener("click", () => {
    chatContainer.classList.toggle("hidden");
});

// Fun√ß√£o para formatar a data/hora da mensagem
function formatarHora(data) {
    const date = new Date(data);
    const horas = date.getHours().toString().padStart(2, '0');
    const minutos = date.getMinutes().toString().padStart(2, '0');
    const segundos = date.getSeconds().toString().padStart(2, '0');
    return `${horas}:${minutos}:${segundos}`;
}

// Fun√ß√£o para adicionar mensagens ao chat com emojis, rank e hora
function adicionarMensagem(data) {
    const item = document.createElement("li");

    // Emojis de rank
    let rankEmoji = '';
    if (data.globalRank === 1) {
        rankEmoji = 'üèÜ';
    } else if (data.globalRank === 2) {
        rankEmoji = 'ü•à';
    } else if (data.globalRank === 3) {
        rankEmoji = 'ü•â';
    } else {
        rankEmoji = 'üí™';
    }

    item.innerHTML = `
        <div class="message-header">
            <span>${rankEmoji} ${data.nome}</span>
            <span class="rank">Rank ${data.globalRank}</span>
            <span class="message-time">${formatarHora(data.data)}</span>
        </div>
        <div class="message-body">${data.texto}</div>
    `;
    messages.appendChild(item);
    messages.scrollTop = messages.scrollHeight; // Rola para a √∫ltima mensagem
}

// Fun√ß√£o para buscar novas mensagens do servidor a cada 1 segundo
function atualizarChat() {
    fetch('/historico-mensagens')
        .then(response => response.json())
        .then(data => {
            messages.innerHTML = '';  // Limpa as mensagens antigas
            data.mensagens.forEach(adicionarMensagem);  // Adiciona as novas mensagens
        })
        .catch(err => {
            console.error('Erro ao carregar mensagens:', err);
        });
}

// Atualiza o chat a cada 1 segundo
//setInterval(atualizarChat, 1000);

let isCooldown = false;
let cooldownTime = 10;    // Tempo de cooldown em segundos
const inputButton = document.querySelector('button[type="submit"]');

// Fun√ß√£o para desabilitar o envio de mensagens durante o cooldown
function startCooldown() {
    isCooldown = true;
    inputButton.disabled = true;
    inputButton.textContent = `Espere ${cooldownTime}s`;  // Atualiza o texto do bot√£o

    const countdown = setInterval(() => {
        cooldownTime--;
        inputButton.textContent = `Espere ${cooldownTime}s`;  // Atualiza o texto com o tempo restante

        if (cooldownTime <= 0) {
            clearInterval(countdown);
            isCooldown = false;
            inputButton.disabled = false;
            inputButton.textContent = "Enviar";
            cooldownTime = 30;  // Reseta o tempo de cooldown
        }
    }, 1000);
}

// Fun√ß√£o para enviar a mensagem
form.addEventListener("submit", async (event) => {
    event.preventDefault();
    const input = document.getElementById("input");

    // Verifica se a mensagem n√£o est√° vazia e se n√£o est√° em cooldown
    if (input.value.trim() && !isCooldown) {
        const data = {
            texto: input.value,
            nome: 'Usu√°rio',  // Este campo deve vir da sess√£o do usu√°rio
            globalRank: 1,   // Este campo deve ser calculado dinamicamente
            data: new Date().toISOString()  // Hora atual formatada
        };

        const response = await fetch('/enviar-mensagem', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        });

        const result = await response.json();
        if (result.sucesso) {
            adicionarMensagem(result.mensagem);
            input.value = '';  // Limpa o campo de entrada
            startCooldown();  // Inicia o cooldown
        } else {
            console.log('Erro ao enviar mensagem:', result);
        }
    } else if (isCooldown) {
        alert(`Voc√™ precisa esperar ${cooldownTime} segundos para enviar uma nova mensagem.`);
    }
});

// Carrega as mensagens ao iniciar a p√°gina
fetch('/historico-mensagens')
    .then(response => response.json())
    .then(data => {
        data.mensagens.forEach(adicionarMensagem);
    })
    .catch(err => {
        console.error('Erro ao carregar mensagens:', err);
    });
  
</script>
<script>
function rolarPara(seletor) {
    const elemento = document.querySelector(seletor);
    if (elemento) {
        elemento.scrollIntoView({ behavior: "smooth" });
    }
}
</script>

<style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');

    .container {
        position: relative;
        font-family: 'Roboto', sans-serif;
    }

    /* Estilo do menu dropdown */
    .dropdown {
        position: fixed;
        top: 20px;
        left: 20px;
        z-index: 1000;
    }

    .dropdown-button {
        background: linear-gradient(135deg, #2575fc, #6a11cb);
        color: white;
        font-size: 1.5em;
        padding: 12px 18px;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
        transition: background 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
    }

    .dropdown-button:hover {
        background: linear-gradient(135deg, #6a11cb, #2575fc);
        transform: scale(1.15);
        box-shadow: 0 14px 35px rgba(0, 0, 0, 0.5);
    }

    /* Conte√∫do do menu dropdown */
    .dropdown-content {
        display: none;
        position: absolute;
        top: 70px;
        left: 0;
        background: rgba(30, 42, 71, 0.95);
        min-width: 220px;
        border-radius: 12px;
        box-shadow: 0 12px 35px rgba(0, 0, 0, 0.5);
        overflow: hidden;
        transition: all 0.4s ease;
    }

    .dropdown:hover .dropdown-content {
        display: block;
        animation: fadeIn 0.4s ease forwards;
    }

    .dropdown-content a {
        color: #fff;
        padding: 14px 20px;
        text-decoration: none;
        display: block;
        font-size: 16px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        transition: background 0.3s ease, padding-left 0.3s ease;
    }

    .dropdown-content a:hover {
        background: #2575fc;
        padding-left: 28px;
    }

    /* Bot√µes estilizados */
    .rank-button, .play-button, .mine-button, .change-password-button, .music-button, #logout-button {
        color: white;
        font-size: 1.1em;
        padding: 14px 26px;
        text-decoration: none;
        display: inline-block;
        border-radius: 50px;
        cursor: pointer;
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(8px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        transition: all 0.4s ease;
        margin: 6px 0;
        text-align: center;
    }

    .rank-button:hover {
        background: linear-gradient(135deg, #FFD700, #FFA500);
        transform: translateY(-3px);
        box-shadow: 0 10px 30px rgba(255, 165, 0, 0.4);
    }

    .play-button:hover {
        background: linear-gradient(135deg, #32CD32, #228B22);
        transform: translateY(-3px);
        box-shadow: 0 10px 30px rgba(34, 139, 34, 0.4);
    }

    .mine-button:hover {
        background: linear-gradient(135deg, #8B4513, #D2691E);
        transform: translateY(-3px);
        box-shadow: 0 10px 30px rgba(210, 105, 30, 0.4);
    }

    .change-password-button:hover {
        background: linear-gradient(135deg, #FFD700, #FFB800);
        transform: translateY(-3px);
        box-shadow: 0 10px 30px rgba(255, 184, 0, 0.4);
    }

    .music-button:hover {
        background: linear-gradient(135deg, #FFD700, #FFA500);
        transform: translateY(-3px);
        box-shadow: 0 10px 30px rgba(255, 165, 0, 0.4);
    }

    #logout-button:hover {
        background: linear-gradient(135deg, #cc0000, #990000);
        transform: translateY(-3px);
        box-shadow: 0 10px 30px rgba(204, 0, 0, 0.5);
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-10px); }
        to { opacity: 1; transform: translateY(0); }
    }
</style>
<script>
  
  document.getElementById("logout-button").addEventListener("click", () => {
    window.location.href = "/logout"; // Redireciona para a rota de logout
});
  
</script>

<style>
    .button-container {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-top: 30px;
    }

    .rank-button, .play-button {
        text-deation: none;
    }

    .rank-button button, .play-button button {
        padding: 15px 30px;
        font-size: 1.5em;
        color: #fff;
        border: none;
        border-radius: 50px;
        cursor: pointer;
        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
        transition: all 0.3s ease-in-out;
        position: relative;
        display: inline-block;
        overflow: hidden;
        text-transform: uppercase;
        font-weight: bold;
    }

    /* Bot√£o VER RANK */
    .rank-button button {
        background: linear-gradient(45deg, #FFD700, #FFA500);
    }

    .rank-button button:hover {
        background: linear-gradient(45deg, #FFA500, #FF8C00);
        transform: scale(1.1);
    }

    .rank-button button::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.2);
        transform: scaleX(0);
        transform-origin: right;
        transition: transform 0.4s ease;
    }

    .rank-button button:hover::before {
        transform: scaleX(1);
        transform-origin: left;
    }

    /* Bot√£o JOGAR */
    .play-button button {
        background: linear-gradient(45deg, #32CD32, #228B22);
    }

    .play-button button:hover {
        background: linear-gradient(45deg, #228B22, #006400);
        transform: scale(1.1);
    }

    .play-button button::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.2);
        transform: scaleX(0);
        transform-origin: right;
        transition: transform 0.4s ease;
    }

    .play-button button:hover::before {
        transform: scaleX(1);
        transform-origin: left;
    }
</style>
<style>
    #roulette {
        font-size: 40px;
        font-weight: bold;
        text-align: center;
        margin-top: 10px;
        transition: transform 0.2s ease-in-out;
    }

    .flash {
        animation: flashEffect 0.5s infinite alternate;
    }

    @keyframes flashEffect {
        0% { opacity: 1; }
        100% { opacity: 0.3; }
    }
</style>




<!-- Notifica√ß√£o de Grande Vit√≥ria -->
<div id="gold-anuncio" class="gold-anuncio">
    <span class="fechar" onclick="fecharGoldAnuncio()">‚úñ</span>
    <h3>üéâ Grande Vit√≥ria! üéâ</h3>
    <p id="gold-mensagem"></p>
</div>

<style>
/* Estilo do an√∫ncio de vit√≥ria */
.gold-anuncio {
    display: none;
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: linear-gradient(135deg, #FFD700, #FF8C00);
    color: white;
    padding: 16px 24px;
    border-radius: 35px;
    font-family: 'Roboto', sans-serif;
    font-size: 17px;
    font-weight: 700;
    text-align: center;
    z-index: 1000;
    animation: aparecer 0.6s ease-out, pulsar 1.8s infinite alternate;
    box-shadow: 0 12px 30px rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(6px);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

/* Efeito de anima√ß√£o de entrada */
@keyframes aparecer {
    from {
        transform: translateY(60px) scale(0.95);
        opacity: 0;
    }
    to {
        transform: translateY(0) scale(1);
        opacity: 1;
    }
}

/* Efeito de pulsa√ß√£o suave */
@keyframes pulsar {
    from {
        transform: scale(1);
    }
    to {
        transform: scale(1.07);
    }
}

/* Bot√£o de fechar */
.fechar {
    position: absolute;
    top: 6px;
    right: 10px;
    cursor: pointer;
    font-size: 20px;
    color: white;
    font-weight: bold;
    transition: color 0.3s ease, transform 0.3s ease;
}

.fechar:hover {
    color: #ffeb3b;
    transform: rotate(90deg);
}

/* Texto destacado */
.gold-anuncio strong {
    font-size: 19px;
    color: #fff700;
    text-shadow: 0 0 6px rgba(0, 0, 0, 0.5);
}
</style>
<script>
  


// Fun√ß√£o para exibir a notifica√ß√£o
function exibirGoldAnuncio(nome, numero, valor) {
    const goldAnuncio = document.getElementById("gold-anuncio");
    const goldMensagem = document.getElementById("gold-mensagem");

    // Remover a parte do n√∫mero ap√≥s o "@" (ex: "@whatsapp.net")
    const numeroFormatado = numero.split('@')[0]; // Pega apenas a parte antes do "@"

    // Atualizar a mensagem com o n√∫mero formatado
    goldMensagem.innerHTML = `üéä ${nome} (#${numeroFormatado}) ganhou <strong>${valor} Golds!</strong> üèÜ`;

    // Exibir o an√∫ncio com um pequeno delay (3 segundos)
    setTimeout(() => {
        goldAnuncio.style.display = "block";  // Exibe a notifica√ß√£o
    }, 3000);  // Aparece depois de 3 segundos

    // Fechar automaticamente ap√≥s 5 segundos
    setTimeout(() => {
        goldAnuncio.style.display = "none";  // Esconde a notifica√ß√£o
    }, 8000);
}

// Fun√ß√£o para buscar e exibir uma notifica√ß√£o aleat√≥ria
/*function buscarNotificacaoAleatoria() {
    fetch('/obterNotificacaoAleatoria')  // Aqui voc√™ chama a rota que retornar√° uma notifica√ß√£o aleat√≥ria
        .then(response => response.json())
        .then(data => {
            exibirGoldAnuncio(data.nome, data.numero, data.valor);
        })
        .catch(error => console.error('Erro ao buscar a notifica√ß√£o:', error));
}*/
//buscarNotificacaoAleatoria()
// Fun√ß√£o para salvar a notifica√ß√£o no arquivo JSON
/*function salvarNotificacao(nome, numero, valor) {
    fetch('/salvarNotificacao', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            nome: nome,
            numero: numero,
            valor: valor
        })
    })
    .then(response => response.json())
    .then(data => console.log('Notifica√ß√£o salva com sucesso:', data))
    .catch(error => console.error('Erro ao salvar a notifica√ß√£o:', error));
}*/

// Exemplo de como voc√™ pode chamar a fun√ß√£o de salvar uma notifica√ß√£o

 



    // Configura√ß√£o do SSE para receber as notifica√ß√µes
   
function fecharGoldAnuncio() {
    document.getElementById("gold-anuncio").style.display = "none";
}


</script>




<!-- Minigame de Minera√ß√£o -->




<footer>
    <div class="footer-bottom">
        <div class="row">
            <div class="col-twelve">
                <div class="copyright">
                    <span><a href="https://wa.link/brgbaw">¬©Gabriel Sam√°. Todos os direitos reservados.</a></span>         
                </div>
                <div>
                    <a href="/docs" class="back-to-docs">Voltar para os Docs</a>
                </div>
            </div>
        </div>   
    </div>
</footer>


</body>

</html>
